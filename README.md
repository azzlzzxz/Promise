<!--
 * @Author: xinxu
 * @Date: 2022-12-20 17:22:04
 * @LastEditors: xinxu
 * @LastEditTime: 2022-12-22 15:05:28
 * @FilePath: /Promise/README.md
-->

# å®ç° Promise

## ä»€ä¹ˆæ˜¯ Promiseï¼Ÿæˆ‘ä»¬ç”¨ Promise æ¥è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ

1. Promise æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼š ä»è¯­æ³•ä¸Šè®²ï¼Œpromise æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»å®ƒå¯ä»¥è·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ï¼›ä»æœ¬æ„ä¸Šè®²ï¼Œå®ƒæ˜¯æ‰¿è¯ºï¼Œæ‰¿è¯ºå®ƒè¿‡ä¸€æ®µæ—¶é—´ä¼šç»™ä½ ä¸€ä¸ªç»“æœã€‚
2. Promise æœ‰ä¸‰ç§çŠ¶æ€ï¼špending(ç­‰å¾…æ€)ï¼Œfulfilled(æˆåŠŸæ€)ï¼Œrejected(å¤±è´¥æ€)ï¼›çŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œå°±ä¸ä¼šå†å˜ã€‚åˆ›é€  promise å®ä¾‹åï¼Œå®ƒä¼šç«‹å³æ‰§è¡Œã€‚
3. ç¼ºé™·ï¼šä¾æ—§æ˜¯åŸºäºå›è°ƒå‡½æ•°çš„ï¼Œè¿›åŒ–--> generator + co / async + awaitã€‚

## ä¸ºä»€ä¹ˆæœ‰ Promise è¿™ä¸ªä¸œè¥¿

1. åŒæ­¥çš„æ–¹å¼å†™å¼‚æ­¥çš„ä»£ç ï¼Œç”¨æ¥è§£å†³å›è°ƒåœ°ç‹±é—®é¢˜ã€‚
2. æ­¤å¤–ï¼Œpromise å¯¹è±¡æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¾—æ§åˆ¶å¼‚æ­¥æ“ä½œæ›´åŠ å®¹æ˜“ã€‚

## ä»€ä¹ˆæ˜¯ Promiseï¼Ÿ

1. Promiseï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼‰çš„ç»“æœã€‚
2. ä»è¯­æ³•ä¸Šè¯´ï¼Œpromise æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»å®ƒå¯ä»¥è·å–å¼‚æ­¥æ“ä½œçš„çš„æœ€ç»ˆçŠ¶æ€ï¼ˆæˆåŠŸæˆ–å¤±è´¥ï¼‰ã€‚
3. Promise æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯¹å¤–æä¾›ç»Ÿä¸€çš„ APIï¼Œè‡ªå·±èº«ä¸Šæœ‰ allã€rejectã€resolve ç­‰æ–¹æ³•ï¼ŒåŸå‹ä¸Šæœ‰ thenã€catch ç­‰æ–¹æ³•ã€‚

## Promise çš„ä¸¤ä¸ªç‰¹ç‚¹

1. Promise å¯¹è±¡çš„çŠ¶æ€ä¸å—å¤–ç•Œå½±å“ï¼Œ1ï¼‰pending åˆå§‹çŠ¶æ€ã€2ï¼‰fulfilled æˆåŠŸçŠ¶æ€ã€3ï¼‰rejected å¤±è´¥çŠ¶æ€ï¼ŒPromise æœ‰ä»¥ä¸Šä¸‰ç§çŠ¶æ€ï¼Œåªæœ‰å¼‚æ­¥æ“ä½œçš„ç»“æœå¯ä»¥å†³å®šå½“å‰æ˜¯å“ªä¸€ç§çŠ¶æ€ï¼Œå…¶ä»–ä»»ä½•æ“ä½œéƒ½æ— æ³•æ”¹å˜è¿™ä¸ªçŠ¶æ€ã€‚
2. Promise çš„çŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œå°±ä¸ä¼šå†å˜ï¼Œä»»ä½•æ—¶å€™éƒ½å¯ä»¥å¾—åˆ°è¿™ä¸ªç»“æœï¼ŒçŠ¶æ€ä¸å¯ä»¥é€†ï¼Œåªèƒ½ç”± pending å˜æˆ fulfilled æˆ–è€…ç”± pending å˜æˆ rejectedã€‚

## æ‰‹å†™ Promise åŒ…å«ä»¥ä¸‹çŸ¥è¯†ç‚¹ ğŸ‘‡ï¼š

1. Promise
2. Class ç±»
3. æ”¹å˜ this æŒ‡å‘ (callã€apply å’Œ bind)
4. äº‹ä»¶å¾ªç¯ Event Loop

### å…ˆæ¥ä»‹ç»ä¸¤ä¸ªå‰ç½®çŸ¥è¯†ï¼š

1. æµè§ˆå™¨çš„ EvenLoop
   ![image](./assest/Browser-EvenLoop.png)
2. Node çš„ EvenLoop
   ![image](./assest/Node-EvenLoop.png)

## å®ç° Promise

### 1.å®ç° resolve å’Œ reject

1. Promise æ˜¯ä¸€ä¸ªç±»ï¼Œç±»ä¸­çš„æ„é€ å‡½æ•°éœ€è¦ä¼ å…¥ä¸€ä¸ª executor ï¼Œé»˜è®¤å°±ä¼šæ‰§è¡Œï¼Œexecutor ä¸­æœ‰ä¸¤ä¸ªå‚æ•° åˆ†åˆ«æ˜¯ resolveï¼Œrejectã€‚
2. è°ƒç”¨æˆåŠŸå’Œå¤±è´¥æ—¶ éœ€è¦ä¼ é€’ä¸€ä¸ªæˆåŠŸçš„åŸå› å’Œå¤±è´¥çš„åŸå› ï¼Œå¦‚æœå·²ç»æˆåŠŸäº†å°±ä¸èƒ½å¤±è´¥äº†ï¼Œå¦‚æœæŠ›å‡ºå¼‚å¸¸æŒ‰ç…§å¤±è´¥æ¥å¤„ç†ã€‚
   [resolve&reject](./1.resolve%26reject/promise.js)

### 2.then æ–¹æ³•çš„å®ç°

[then](./2.then/promise.js)

### 3.then æ–¹æ³•çš„å¼‚æ­¥å®ç°

[then çš„å¼‚æ­¥](3.thenAsync/promise.js)

### 4.then æ–¹æ³•çš„é“¾å¼è°ƒç”¨

å› ä¸ºæ¯æ¬¡è°ƒç”¨ then æ–¹æ³•ï¼Œä¼šäº§ç”Ÿæ–°çš„ Promiseï¼Œæ‰èƒ½ä¿è¯çŠ¶æ€ä¸€ç›´æ”¹å˜ï¼ˆå½“ä¸Šå±‚ promsie å¤±è´¥æ—¶ï¼Œä¹‹åèµ°èµ· then æ–¹æ³•çš„ onRejectï¼Œè¿”å›æ–°çš„ Promise ä¼šèµ°å…¶ then æ–¹æ³•çš„ onFulfilledï¼‰ã€‚

1. å¦‚æœ then æ–¹æ³•ä¸­ï¼ˆæˆåŠŸæˆ–å¤±è´¥ï¼‰ï¼Œè¿”å›çš„ä¸æ˜¯ä¸€ä¸ª Promiseï¼Œé‚£ä¹ˆä¼šå°†å€¼ï¼ˆthen çš„è¿”å›å€¼ï¼‰ä¼ é€’ç»™å¤–å±‚ä¸‹ä¸€æ¬¡ then çš„æˆåŠŸçš„ç»“æœï¼Œå¦‚æœ then æ–¹æ³•å‡ºé”™ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™ä¼šèµ°å¤–å±‚ä¸‹ä¸€ä¸ª then æ–¹æ³•çš„å¤±è´¥ã€‚
2. å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ª Promiseï¼Œåˆ™ä¼šç”¨è¿™ä¸ª Promise çš„æˆåŠŸ/å¤±è´¥ï¼Œèµ°å¤–å±‚ä¸‹ä¸€ä¸ª then çš„æˆåŠŸ/å¤±è´¥ã€‚
3. è¿”å›çš„ Promise å‡ºé”™ï¼ˆå¤±è´¥ï¼‰å°±å¤±è´¥ ---> å…¶ä»–ä¸€å¾‹ä¼šèµ°ä¸‹ä¸€ä¸ª then çš„æˆåŠŸé‡Œã€‚
4. catch å°±æ˜¯ then çš„åˆ«å æ²¡æœ‰æˆåŠŸåªæœ‰å¤±è´¥ ï¼ˆæ‰¾æœ€è¿‘çš„ä¼˜å…ˆå¤„ç†ï¼Œå¤„ç†ä¸äº†æ‰¾ä¸‹ä¸€å±‚ï¼‰ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ promise å¤±è´¥äº†ï¼Œä¼šå…ˆæ‰¾ then çš„ onReject æ–¹æ³•å»è¿”å›å¤±è´¥çš„å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ°å°±ä¼šèµ° catchï¼‰ã€‚
   ![image](./assest/promise.png)
   [then æ–¹æ³•çš„é“¾å¼è°ƒç”¨](4.promise/promise.js)

### 5.promise çš„å…¶ä»–æ–¹æ³•

[promise çš„å…¶ä»–æ–¹æ³•](5.promiseMethod/promise.js)
